import Lecture6
import Exercises
import Test.QuickCheck

-- TODO Exercises 2
propEqual (Positive a, Positive b, Positive c) = exM a b c == expM a b c 
testEx2 = quickCheck propEqual

-- Execution of tests of exercise 4, 5 and 6
testEx4, testEx5, testEx6 :: Int -> Int -> [Char]-> IO ()
testEx4 nt n msg = testPrime nt (take n composites) primeTestsF msg
testEx5 nt n msg = testPrime nt (take n carmichael) primeTestsF msg
testEx6 nt n msg = testPrime nt (take n carmichael) primeMR msg

-- Exercise 4
-- The Fermat Primality check is probabilistic test, relient on a random 
-- variable. Forinstance if we want to know if N is prime then it picks a 
-- value between 1 and N (random) and uses this to estimate if it is a prime.
-- When we higher 'nt' (number of tests) N will be compared to more numbers
-- and therefore be more accurate. This is confirmed in our test.
ex4 = do
  testEx4 1 1000 "Ex4: 1 test\n\n" --(average 16 of 1000 primes are wrongly estimated)
  testEx4 2 1000 "Ex4: 2 tests\n\n"--(average  2 of 1000 primes are wrongly estimated)
  testEx4 3 1000 "Ex4: 3 tests\n"  --(average  1 of 1000 primes are wrongly estimated)

-- Exercise 5
-- Carmicheal numbers are composite numbers which statifies a relation
-- on which the Fermat primility check is based. Since (looking at the
-- implementation of this lecture's Carmicheal numbers) the Carmichael
-- numbers are composed of the multiplication of three primes which gives
-- them the property that they have a low amount of coprimes. Since 
-- the Fermat test is probabilistic the chance is low it will take a 
-- random number beteween 0 and a carmicheal number which is coprime
-- with the Carmichael number. Therefore with a low amount of tests the
-- Fermat test will likely falsly determine that a Carmicheal number is
-- prime, given that Carmichael numbers are composites the Fermat 
-- test failed. 
-- But if we would increase the number of tests of the Fermat test it
-- should be more accurate and correctly identify the Carmicheal as
-- a non-prime.
-- Our results on the first 10 Carhmichael numbers confirm this theory:
ex5 = do
  testEx5 1   10 "Ex5: 1 test\n\n" --(failed 10 times (average))
  testEx5 800 10 "Ex5: 800 tests\n"--(failed  1 times (average))

-- Exercise 6
-- The Miller Rabin test should be more robust and  accurate than 
-- the Fermat test, this is logical because it actually includes the 
-- Fermat test and applies an additional test. Our results again 
-- confirm the theory, the Miller Rabin test falsly identifies 
-- far less Carmichael numbers as primes:
ex6 = do
  testEx6 1 10 "Ex6: 1 test\n\n" --(failed 1 times (average))
  testEx6 2 10 "Ex6: 2 tests\n"  --(failed 0 times(average))

-- Exercise 6 Mersene primes
-- We found that one Miller Rabin test is actually sufficient to 
-- accuratlly calculate mersenne primes, during all manual testing
-- we never encounterd an invalid mersenne prime. The following 
-- function checks the first 0-601 primes for Mersenne primes with
-- only 1 Miller Rabin check. This takes around 20 seconds in
-- intepreted mode. This is just for preview, you can start at any
-- prime. The highest Mersene prime we found was from prime 44497,
-- and checkd against wikipedia it was correct. (this was done
-- during the night, since after prime 4423 it will go fairly slow)

first20mers = findMersene 1 0 601

--  Result of first20mers:
-- "2 Marsenne found 3"
-- "3 Marsenne found 7"
-- "5 Marsenne found 31"
-- "7 Marsenne found 127"
-- "13 Marsenne found 8191"
-- "17 Marsenne found 131071"
-- "19 Marsenne found 524287"
-- "31 Marsenne found 2147483647"
-- "61 Marsenne found 2305843009213693951"
-- "89 Marsenne found 618970019642690137449562111"
-- "107 Marsenne found 162259276829213363391578010288127"
-- "127 Marsenne found 170141183460469231731687303715884105727"
-- "521 Marsenne found 6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151"
-- "607 Marsenne found 531137992816767098689588206552468627329593117727031923199444138200403559860852242739162502265229285668889329486246501015346579337652707239409519978766587351943831270835393219031728127"
-- "1279 Marsenne found 10407932194664399081925240327364085538615262247266704805319112350403608059673360298012239441732324184842421613954281007791383566248323464908139906605677320762924129509389220345773183349661583550472959420547689811211693677147548478866962501384438260291732348885311160828538416585028255604666224831890918801847068222203140521026698435488732958028878050869736186900714720710555703168729087"
-- "2203 Marsenne found 1475979915214180235084898622737381736312066145333169775147771216478570297878078949377407337049389289382748507531496480477281264838760259191814463365330269540496961201113430156902396093989090226259326935025281409614983499388222831448598601834318536230923772641390209490231836446899608210795482963763094236630945410832793769905399982457186322944729636418890623372171723742105636440368218459649632948538696905872650486914434637457507280441823676813517852099348660847172579408422316678097670224011990280170474894487426924742108823536808485072502240519452587542875349976558572670229633962575212637477897785501552646522609988869914013540483809865681250419497686697771007"
-- "2281 Marsenne found 446087557183758429571151706402101809886208632412859901111991219963404685792820473369112545269003989026153245931124316702395758705693679364790903497461147071065254193353938124978226307947312410798874869040070279328428810311754844108094878252494866760969586998128982645877596028979171536962503068429617331702184750324583009171832104916050157628886606372145501702225925125224076829605427173573964812995250569412480720738476855293681666712844831190877620606786663862190240118570736831901886479225810414714078935386562497968178729127629594924411960961386713946279899275006954917139758796061223803393537381034666494402951052059047968693255388647930440925104186817009640171764133172418132836351"
-- "3217 Marsenne found 259117086013202627776246767922441530941818887553125427303974923161874019266586362086201209516800483406550695241733194177441689509238807017410377709597512042313066624082916353517952311186154862265604547691127595848775610568757931191017711408826252153849035830401185072116424747461823031471398340229288074545677907941037288235820705892351068433882986888616658650280927692080339605869308790500409503709875902119018371991620994002568935113136548829739112656797303241986517250116412703509705427773477972349821676443446668383119322540099648994051790241624056519054483690809616061625743042361721863339415852426431208737266591962061753535748892894599629195183082621860853400937932839420261866586142503251450773096274235376822938649407127700846077124211823080804139298087057504713825264571448379371125032081826126566649084251699453951887789613650248405739378594599444335231188280123660406262468609212150349937584782292237144339628858485938215738821232393687046160677362909315071"
-- "4253 Marsenne found 190797007524439073807468042969529173669356994749940177394741882673528979787005053706368049835514900244303495954950709725762186311224148828811920216904542206960744666169364221195289538436845390250168663932838805192055137154390912666527533007309292687539092257043362517857366624699975402375462954490293259233303137330643531556539739921926201438606439020075174723029056838272505051571967594608350063404495977660656269020823960825567012344189908927956646011998057988548630107637380993519826582389781888135705408653045219655801758081251164080554609057468028203308718724654081055323215860189611391296030471108443146745671967766308925858547271507311563765171008318248647110097614890313562856541784154881743146033909602737947385055355960331855614540900081456378659068370317267696980001187750995491090350108417050917991562167972281070161305972518044872048331306383715094854938415738549894606070722584737978176686422134354526989443028353644037187375385397838259511833166416134323695660367676897722287918773420968982326089026150031515424165462111337527431154890666327374921446276833564519776797633875503548665093914556482031482248883127023777039667707976559857333357013727342079099064400455741830654320379350833236245819348824064783585692924881021978332974949906122664421376034687815350484991"
-- "4423 Marsenne found 285542542228279613901563566102164008326164238644702889199247456602284400390600653875954571505539843239754513915896150297878399377056071435169747221107988791198200988477531339214282772016059009904586686254989084815735422480409022344297588352526004383890632616124076317387416881148592486188361873904175783145696016919574390765598280188599035578448591077683677175520434074287726578006266759615970759521327828555662781678385691581844436444812511562428136742490459363212810180276096088111401003377570363545725120924073646921576797146199387619296560302680261790118132925012323046444438622308877924609373773012481681672424493674474488537770155783006880852648161513067144814790288366664062257274665275787127374649231096375001170901890786263324619578795731425693805073056119677580338084333381987500902968831935913095269821311141322393356490178488728982288156282600813831296143663845945431144043753821542871277745606447858564159213328443580206422714694913091762716447041689678070096773590429808909616750452927258000843500344831628297089902728649981994387647234574276263729694848304750917174186181130688518792748622612293341368928056634384466646326572476167275660839105650528975713899320211121495795311427946254553305387067821067601768750977866100460014602138408448021225053689054793742003095722096732954750721718115531871310231057902608580607"